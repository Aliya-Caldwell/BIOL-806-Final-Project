---
title: "Assessing Common Tern (<em> Sterna hirundo </em>) diet community"
author: "Aliya Caldwell; BIOL 806 final project"
output: pdf_document
bibliography: RClassFinalProjBib.bib
nocite: |
  @noauthor_r_2021
editor_options: 
  chunk_output_type: console
---

## INTRODUCTION
Predator-prey interactions can vary greatly over space and time, and can shape ecosystems in marine environments (@mccann_dynamics_2005). The relationship between colonially breeding seabirds, which are central place foragers, and transient fishes represents one such relationship. Central place foraging seabirds return to the same breeding colonies each year, selecting their prey within a restricted distance from their colony and during specific times of year correlated to their breeding phenology (@burke_foraging_2009). In contrast, the small and juvenile fishes ("forage fishes") they rely on for food are transient in space and time, though they can maintain some degree of predictability, particularly during spawning seasons (@nye_changing_2009). Due to their central place foraging strategy, along with their sensitivity and ease of sampling, seabirds may be particularly well suited to track changes in the communities of their fish prey, which are more capable of undergoing shifts in space and time, especially across decadal time periods where long-term processes like climate change may impact their populations (@einoder_review_2009). Understanding these predator-prey relationships, while potentially important for understanding prey communities, is also crucial for the management and conservation of predators relying on those resources.

Here, I briefly explore the predator-prey relationships between Common Terns (<em> Sterna hirundo </em>) and their prey fishes, and the use of tern diet as an indicator of fish populations and communities. Common Terns are small, long-lived, and highly-migratory seabirds with high natal philopatry (@arnold_common_2020). In New Hampshire (NH), their population is restricted to a single breeding colony on White and Seavey Islands, 7 miles off the mainland coast. In the rivers, estuaries, and offshore areas surrounding the colony, the terns feed on forage fishes including herrings (<em> Clupea sp. </em> and <em> Alosa spp. </em>), hakes (<em> Merluccius sp. </em> and <em> Urophycis spp.</em>), sand lances (<em> Ammodytes spp. </em>), pollock/haddock (<em> Pollachius pollachius </em> and <em> Melanogrammus aeglefinus </em> ), mackerel (<em> Scomber scombrus </em>), and mummichog (<em> Fundulus heteroclitus </em>), among others (@arnold_common_2020). While all of these fish species serve important ecological mechanisms, especially as juveniles as prey items, many also represent important fisheries in the region. Therefore, understanding the predator-prey relationship between terns and forage fishes items over time is important for understanding how the tern diet community has shifted over time, but also for evaluating the potential use of the predator-prey relationship for monitoring and predicting fish populations of economic importance. To examine these dyanimics, I first explore the entire tern prey community over more than 20 years, specifically asking how the community has shifted during that time and how variable the community is among years. Next, I use herring and hake, the two prey groups most often utilized by terns, as a case study to explore how seabird data might be used to track fish populations over time.
  
  
  
## METHODS

### Data Collection
The seabird diet data used for this study were collected annually from 1999 to 2020 on White and Seavey Islands, NH by the Shoals Marine Laboratory Tern Conservation Program. Diet data are collected during “diet watches” conducted during the chick rearing period, which spans from early June to early August of each year. In recent years (2017-present), diet watches are conducted at four specified sampling areas on the colony that are visible from one of two or three observation blinds. Before 2017, data were collected from six blinds at a higher number of diet sampling areas throughout the colony. At each of these areas, 5 to 10 nests are identified for monitoring throughout the season, resulting in sample sizes of 20 to 50 nests each year. As chicks fledge or die throughout the breeding season, new nests may be added to the study to maintain a balanced sample size colony-wide. Diet watches are conducted for a single diet area from the observation blind for a duration of 1 to 3 hours, during which time the observer monitors all the nests within the specified area. For each feeding that occurs during the watch, the observer collects data including event time, prey identity, estimated prey size (measured relative to the adult tern bill length), and chick fed (chicks are colored to indicate hatch order). In addition to live diet observations, 20-30 nests (some that overlap with live observation nests and others that do not) are monitored via remote automated video camera (Axis P5635-E) and GoPro video camera throughout the Common Tern chick rearing period. The cameras watch a single frame containing one or two nests at a time for a duration of 60-120 minutes. Videos are later analyzed to collect the same data types collected during live diet watches. 

### Data Analysis
To characterize the tern prey community, variables for the proportion of each species in the tern diet and the relative abundance or catch per unit effort (CPUE, number of fish per unit sampling effort) of fish species in the diet were calculated for different time periods (daily, weekly, monthly, yearly). Sampling effort was measured in "nest minutes", which describes the total amount of time spent observing nests during any specified time period (i.e. the total minutes of observation performed in a day). Though effort was accounted for, years with exceptionally low effort, such that the sample might no longer reflect the overall population, were excluded from the analyses. The metrics described above, along with fish size, were used for the subsequent analyses.

To characterize prey community over time, the proportion of each prey species in the tern diet, along with the CPUE of fishes caught by the study individuals, was explored. For this analysis, species making up <1% of the tern diet (by number over the entire timeseries) were lumped into a category designated "other". The proportion of species present in the diet over the two decades was explored visually and in comparison with annual CPUE on the colony as well as annual prey species diversity measured via Shannon's Diversity Index. Next, non-metric multidimensional scaling analysis (NMDS; using R packages <em>'vegan'</em> and <em>'moments'</em>) was used to examine associations among prey items in the community over time. The observations for which the NMDS was run were the daily proportions of fish species in the tern diet (i.e. each observation comprises a single day of observational data, for which species proportions were calculated to create a row in the distance matrix). The NMDS was run over 250 random starts using the Bray-Curtis distance measure. Models with stress levels <20 were considered useful and plotted in 2 dimensions with time bins (1999-2006, 2007-2013, and 2014-2020) overlaid to assess changes in prey community over time.

To assess changes in herring and hake populations and body sizes over time, the CPUE for each species was summed for each year and the size data were converted from bill lengths to millimeters (mm) using the average bill length of adult tern sampled on the colony. Annual CPUE was regressed (linearly) over time for each species to assess population trends in the diet over time. Density plots were used to visualize changes in herring and hake size over time, and linear reggressions were run to further explore the relationships. All analyses were conducted in R (R Core Team 2021 Version 4.1.1).


\newpage
## RESULTS
### Diet Community
Figure \ref{fig:preyspeciesproportions}, shows some degree of variability in the proportion of fish species making up the diet as well as in the relative abundance of landings of all species combined. Species of herring and hake dominate the diet across the time series, in combination making up over 50% of the total landings in most years. That being said, like with other species, the two show a fair amount of variability year to year. 

While we do see some variability in the proportion of species ingested by terns across years (Figure \ref{fig:preyspeciesproportions}), no clear directional trend presents itself when investigating dietary diversity over time (Shannon's Index; Figure \ref{fig:shannon}). However, it does appear that interannual differences in diversity have increased through time, with some interannual variability in diversity present in the early 2000's followed by a period of higher interannual changes diversity in the early 2010s.

``` {r, echo=FALSE, message=FALSE, warning=FALSE, fig.width=8,fig.height=3, fig.pos="H", fig.cap="\\label{fig:preyspeciesproportions} Proportions of fish species in the Common Tern diet from 1999 to 2020 plotted against catch per unit effort (CPUE; fish per nest minute) in black. "}

rm(list=ls())
library(ggplot2)
library(plyr)
library(dplyr)
library(tidyr)
library(grid)
library(palettetown)
library(colorspace)
library(RColorBrewer)
library(pals)

setwd("/Users/aliyacaldwell/Box/SML Tern Program/Raw data/Feeding data")

df<-read.csv("T-Feeding up to 2020.csv",fileEncoding="UTF-8-BOM")

dfclean<-df %>%
  dplyr::rename(size='PreySizeMM') %>%
  dplyr::rename(prey='PreyFamily') %>%
  dplyr::rename(method='ObservationType') %>%
  dplyr::rename(year='Year') %>%
  dplyr::rename(day='DayOfYear') %>%
  dplyr::rename(week='WeekOf.Year') %>%
  dplyr::rename(month='Month') %>%
  dplyr::rename(watchtime='WatchDurationMM') %>%
  dplyr::rename(nestswatched='NumberNestsObserved') %>%
  dplyr::rename(event='Event')

#sampling effort
effort<-dfclean %>%
  filter(!IncludeForRegression %in% c("no")) %>% 
  dplyr::mutate(`sampling effort`=(watchtime*as.numeric(nestswatched))) %>%
  group_by(year) %>%
  dplyr::summarise(`Effort (nest mins)`=sum(`sampling effort`, na.rm=T))

#diet data
fish<-dfclean %>%
  filter(! event %in% c("end","start")) %>% 
  filter(! prey %in% c("")) %>% 
  group_by(year,prey) %>%
  dplyr::summarise(n=n(), meansize=mean(as.numeric(size),na.rm=T), mediansize=median(as.numeric(size),na.rm=T)) %>%
  dplyr::mutate(prop=n/sum(n))

#combine and generate relative abundance
fisheffort<-merge(effort,fish) %>%
  mutate(`relative abundance (fish per nest min)`=(n/`Effort (nest mins)`))

#FINAL DATAFRAME (remove intermediate effort column, rename columns for easy use)
tprov<-fisheffort %>%
  dplyr::select(year, prey, n, meansize, mediansize, `Effort (nest mins)`, prop, `relative abundance (fish per nest min)`) %>%
  dplyr::rename(proportion=prop) %>%
  dplyr::rename(abundance=`relative abundance (fish per nest min)`)


#=======================================================#
## PLOTTING the PROPORTIONS and abundance of PREY ITEMS in THE DIET  ##
#=======================================================#
dfclean<-df %>%
  dplyr::rename(size='PreySizeMM') %>%
  dplyr::rename(prey='PreyFamily') %>%
  dplyr::rename(method='ObservationType') %>%
  dplyr::rename(year='Year') %>%
  dplyr::rename(day='DayOfYear') %>%
  dplyr::rename(week='WeekOf.Year') %>%
  dplyr::rename(month='Month') %>%
  dplyr::rename(watchtime='WatchDurationMM') %>%
  dplyr::rename(nestswatched='NumberNestsObserved') %>%
  dplyr::rename(event='Event')

dfcleansub<-dfclean %>% 
  filter(! prey %in% c("unknown","unknown fish", "invert"))

#sampling effort
effort<-dfcleansub %>%
  filter(!IncludeForRegression %in% c("no")) %>% 
  dplyr::mutate(`sampling effort`=(watchtime*as.numeric(nestswatched))) %>%
  group_by(year) %>%
  dplyr::summarise(`Effort (nest mins)`=sum(`sampling effort`, na.rm=T))

#diet data
fishsub<-dfcleansub %>%
  filter(! event %in% c("end","start")) %>% 
  filter(! prey %in% c("")) %>% 
  group_by(year,prey) %>%
  dplyr::summarise(n=n(), meansize=mean(as.numeric(size),na.rm=T), mediansize=median(as.numeric(size),na.rm=T)) %>%
  dplyr::mutate(prop=n/sum(n))

#combine and generate relative abundance
fisheffortsub<-merge(effort,fishsub) %>%
  mutate(`relative abundance (fish per nest min)`=(n/`Effort (nest mins)`))

tprovsub<-fisheffortsub %>%
  dplyr::select(year, prey, n, meansize, mediansize, `Effort (nest mins)`, prop, `relative abundance (fish per nest min)`) %>%
  dplyr::rename(proportion=prop) %>%
  dplyr::rename(abundance=`relative abundance (fish per nest min)`)


#main five prey categories, good sample size years tern data
#----------------------------------------------------------#
tprovsub<-tprovsub %>% 
  filter(! prey %in% c("unknown", "unknown fish", "invert"))
tprovsub<-tprovsub %>%
  mutate(preysub=preysub<-ifelse(grepl(paste(c("herring","lumpfish","hake","butterfish","sandlance","mackerel","bluefish","cunner","pollock","mummichog","stickleback"),
                                             collapse="|"), prey, ignore.case=T), prey, "other")) %>%
  filter(! year %in% c(2003, 2004, 2010, 2012))

tprovsub[,9]=toupper(tprovsub[,9]) #make prey uppercase

#total relative abundance, good sample years (i.e. "total relative landings") 
tprovabundance<-tprovsub %>%
  dplyr::group_by(year) %>%
  dplyr::summarise(totalabundance=sum(abundance)) %>%
  filter(! year %in% c(2003, 2004, 2010, 2012))

ggplot()+
  geom_col(data=tprovsub,aes(x=year, y=proportion, fill=preysub))+theme_bw()+
  ylab("Proportion of Total Observations")+xlab("Year")+
  theme(axis.text = element_text(size=12), axis.title = element_text(size=12),
        legend.text = element_text(size=12),legend.title = element_text(size=12),
        panel.grid.major=element_blank(), panel.grid.minor=element_blank())+
  scale_x_continuous(expand=c(0,0.01))+scale_y_continuous(expand=c(0,0.001))+
  labs(fill="Prey")+
  scale_fill_poke(pokemon="surskit", spread=12)+
  geom_point(data=tprovabundance, aes(x=year, y=totalabundance*20),size=2)+
  geom_line(data=tprovabundance, aes(x=year, y=totalabundance*20), size=1)+
  scale_x_continuous(expand=c(0,0.01),name="Year")+
  scale_y_continuous(expand=c(0,0.001),
                     name="Proportion in diet", sec.axis=sec_axis(~./20, name="Total abundance (fish/nest min)"))+
  theme(legend.title = element_text( size=10), legend.text=element_text(size=10))+theme(legend.key.size = unit(0.9,"line"))

```



```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.width=8,fig.height=3, fig.pos="H", fig.cap="\\label{fig:shannon} Proportions of fish species in the Common Tern diet from 1999 to 2020 plotted against Shannon Diversity Index in black. "}
tprovfish<-tprov %>%
  filter(! year %in% c(2003, 2004, 2010, 2012, 2016)) %>% 
  filter(! prey %in% c("unknown", "unknown fish", "other"))


## calculate shannon diversity
tprovshannon<-tprovfish %>% 
  dplyr::select(year,prey,proportion) %>% 
  dplyr::group_by(year) %>% 
  dplyr::summarise(H=sum((proportion)*log10(proportion)*-1))
  


#plot shannon diversity on top of proportions in diet data  
ggplot()+
  geom_col(data=tprovsub,aes(x=year, y=proportion, fill=preysub))+theme_bw()+
  ylab("Proportion of Total Observations")+xlab("Year")+
  theme(axis.text = element_text(size=12), axis.title = element_text(size=12),
        legend.text = element_text(size=12),legend.title = element_text(size=12),
        panel.grid.major=element_blank(), panel.grid.minor=element_blank())+
  scale_x_continuous(expand=c(0,0.01))+scale_y_continuous(expand=c(0,0.001))+
  labs(fill="Prey")+
  scale_fill_poke(pokemon="surskit", spread=12)+
  geom_point(data=tprovshannon, aes(x=year, y=H),size=2)+
  geom_line(data=tprovshannon, aes(x=year, y=H), size=1)+
  scale_x_continuous(expand=c(0,0.01),name="Year")+
  scale_y_continuous(expand=c(0,0.001),
                     name="Proportion in diet", sec.axis=sec_axis(~./20, name="Shannon Diversity Index"))+
  theme(legend.title = element_text( size=10), legend.text=element_text(size=10))+theme(legend.key.size = unit(0.9,"line"))
  
```


\newpage

The results from the NMDS (Figure \ref{fig:preyspeciesNMDS}) showed some associations between fish species in the tern diet. Specifically, strong grouping appeared among herring, bluefish, and sandlance and between lumpfish and hake. Weaker grouping was also observed among butterfish, mummichog, and mackerel, with cunner also positively associated with the group (Figure \ref{fig:preyspeciesNMDS}). The three time periods overlaid on the ordination all overlap one another, with the central time period (2007-2013) entirely contained within the other two. The earliest (1999-2006) and latest (2014-2020) time periods do show some distinction from one another, indicating that the tern diet community may have shifted slightly over time (Figure \ref{fig:preyspeciesNMDS}).

```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.width=8,fig.height=6, fig.pos="H", fig.cap="\\label{fig:preyspeciesNMDS} Plot showing NMDS results for Common Tern diet data from 1999 to 2020. Colors indicate time period and elipses encompass 95% of datapoints from each period."}

load(file = "globalenv.RData")
myord

```



\newpage

## Case Study: herrings and hakes

Early in the timeseries, the abundances of hake and herring species in the tern diet were contradictory (i.e. when one was high, the other was low), while the two began to instead mirror one another in 2009 (Figure \ref{fig:HerringandHakePopulationTrendsLine}). When abundance is regressed linearly against time for the two species, hake abundance in the seabird diet appears to fit the model well, decreasing over time with historic (1999) numbers dropping to nearly half of their values by the end of the timeseries (Figure \ref{fig:HerringandHakePopulationTrendsLinearModelFacets}). Herring abundances, however, do not appaer to follow a linear trend, fluxuating significantly over time in no clear pattern (Figure \ref{fig:HerringandHakePopulationTrendsLinearModelFacets}).

```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.width=8,fig.height=3.5, fig.pos="H", fig.cap="\\label{fig:HerringandHakePopulationTrendsLine} Total catch per unit effort (CPUE; fish per nest minute) of herring and hake by Common Terns from 1999 to 2020."}

# population size over time facet linear model
tprovherringandhake<-subset(tprov, prey=="herring" | prey=="hake")
tprovherringandhake<-tprovherringandhake %>% 
    filter(! year %in% c(2003, 2004, 2010, 2012))


ggplot()+theme_classic()+
  geom_point(data=tprovherringandhake, aes(x=year, y=abundance, color=prey),size=2)+
  geom_line(data=tprovherringandhake, aes(x=year, y=abundance, color=prey),size=1)+
  scale_color_manual(values=c("indianred","skyblue3"))+ 
  theme(axis.text = element_text(size=10), axis.title = element_text(size=12),
        legend.text = element_text(size=10),legend.title = element_text(size=12))+
  scale_x_continuous(expand=c(0,0.01),name="Year")+
  scale_y_continuous(expand=c(0,0.001),
                     name="abundance (total fish/nest mins)")+
  theme(legend.title = element_blank())+
  scale_x_continuous(breaks = seq(2000, 2020, by = 2))+
  theme(strip.background = element_blank(), strip.text=element_blank())+
  theme(legend.position = "top", legend.text=element_text(size=12))

```



```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.width=8,fig.height=4, fig.pos="H", fig.cap="\\label{fig:HerringandHakePopulationTrendsLinearModelFacets} Total catch per unit effort (CPUE; fish per nest minute) of herring and hake by Common Terns from 1999 to 2020 fit with linear models."}

# population size over time facet linear model
tprovherringandhake<-subset(tprov, prey=="herring" | prey=="hake")
tprovherringandhake<-tprovherringandhake %>% 
    filter(! year %in% c(2003, 2004, 2010, 2012))


ggplot()+theme_classic()+
    geom_smooth(data=tprovherringandhake, aes(x=year, y=abundance, color=prey), method="lm", level=0.95, fill="gray80")+ 
  geom_point(data=tprovherringandhake, aes(x=year, y=abundance, color=prey),size=3)+
  scale_color_manual(values=c("indianred","skyblue3"))+ 
  theme(axis.text = element_text(size=10), axis.title = element_text(size=12))+
  scale_x_continuous(expand=c(0,0.01),name="Year")+
  scale_y_continuous(expand=c(0,0.001),
                     name="abundance (total fish/nest mins)")+
  theme(legend.title = element_blank())+
  scale_x_continuous(breaks = seq(2000, 2020, by = 4))+facet_wrap(~prey)+
  theme(strip.background = element_blank(), strip.text=element_blank())+
  theme(legend.position = "top", legend.text=element_text(size=12))

```


\newpage
The sizes of herrings ingested by terns appears to have increased over time, with herring averaging ~50mm in size in the early 2000's and with those later in the time series averaging ~100mm. The overall range of sizes ingested also appears to have broadened over time (Figure \ref{fig:HerringSizeSinglePane}). The apparent increase in size appears significant when the data are fit with a linear model (Figure \ref{fig:HerringSizeRegression}).


```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.width=8,fig.height=3.5, fig.pos="H", fig.cap="\\label{fig:HerringSizeSinglePane} Annual size distribution of herrings caught by Common Terns from 1999 to 2020."}

nb.cols<-15
mycolors <- rev(colorRampPalette(brewer.pal(8, "Blues"))(nb.cols))

#single pane
ggplot(herringsub)+theme_classic()+
  geom_density(aes(x=size, color=as.character(year), fill=as.character(year)),
               adjust=3,alpha=0.7,size=1.5)+
  scale_fill_manual(values=mycolors, name="year")+
  scale_color_manual(values=mycolors, name="year")+
  xlab("Herring Length (mm)")+
  guides(color=guide_legend("year"))+theme(legend.key.size = unit(1,"line"))
```


```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.width=8,fig.height=3.5, fig.pos="H", fig.cap="\\label{fig:HerringSizeRegression} Mean (solid line, closed points) and median (dashed line, open points) size of herrings in the Common Tern diet regressed linearly over time between 1999 and 2020."}

tprovsubsizeherr<-tprov %>% 
  filter(prey %in% c("herring")) %>% 
  filter(! year %in% c(2003, 2004, 2010, 2012, 2006, 2017))

ggplot(tprovsubsizeherr)+theme_classic()+
  geom_point(aes(x=year,y=meansize, color=prey))+
  geom_point(aes(x=year,y=mediansize, color=prey), pch=21)+
  scale_color_manual(values=c("skyblue3"))+ 
  geom_smooth(data=tprovsubsizeherr, aes(x=year, y=mediansize, color=prey), method="lm", level=0.95, linetype = "dashed", fill="gray80")+
  ylab("size (mm)")+
  geom_smooth(data=tprovsubsizeherr, aes(x=year, y=meansize, color=prey), method="lm", level=0.95, fill="gray50")+theme(legend.position="none")

```


\newpage
Hake follow a similar trend, with sizes increasing from around 25mm at the beginning of the timeseries to around 50mm toward the end, though 2020 sizes do appear to break this trend by returning to historic levels. Unlike in herring, the overall size range does not seem to have broadened much over time (Figure \ref{fig:hakeSizeSinglePane}). The increase in size observed in the density plots appears meaninful when the data are fit with a linear model (Figure \ref{fig:hakeSizeRegression}).


```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.width=8,fig.height=3.5, fig.pos="H", fig.cap="\\label{fig:hakeSizeSinglePane} Annual size distribution of hakes caught by Common Terns from 1999 to 2020."}

nb.cols<-17
mycolors <- rev(colorRampPalette(brewer.pal(8, "OrRd"))(nb.cols))

#single pane
ggplot(hakesub)+theme_classic()+
  geom_density(aes(x=size, color=as.character(year), fill=as.character(year)),
               adjust=3,alpha=0.5,size=1.5)+
  scale_fill_manual(values=mycolors, name="year")+
  scale_color_manual(values=mycolors, name="year")+
  xlab("Hake Length (mm)")+
  guides(color=guide_legend("year"))+theme(legend.key.size = unit(1,"line"))

```


```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.width=8,fig.height=3.5, fig.pos="H", fig.cap="\\label{fig:hakeSizeRegression} Mean (solid line, closed points) and median (dashed line, open points) size of hakes in the Common Tern diet regressed linearly over time between 1999 and 2020."}

# hake size over time 
tprovsubsizehake<-tprov %>% 
  filter(prey %in% c("hake")) %>% 
  filter(! year %in% c(2003, 2004, 2010, 2012))


ggplot(tprovsubsizehake)+theme_classic()+
  geom_point(aes(x=year,y=meansize, color=prey))+
  geom_point(aes(x=year,y=mediansize, color=prey), pch=21)+
  scale_color_manual(values=c("indianred"))+ 
  geom_smooth(data=tprovsubsizehake, aes(x=year, y=mediansize, color=prey), method="lm", level=0.95, linetype = "dashed", fill="gray80")+
  ylab("size (mm)")+
  geom_smooth(data=tprovsubsizehake, aes(x=year, y=meansize, color=prey), method="lm", level=0.95, fill="gray50")+theme(legend.position="none")

```


\newpage
## DISCUSSION
Common Tern diet, while somewhat variable in species make-up, is regularly dominated by species of herring and hake (Figure \ref{fig:preyspeciesproportions}; Figure \ref{fig:shannon}). While the two always co-occur in the diet, there is some evidence that they may be negatively related at times, especially toward the beginning of the time series (Figure \ref{fig:HerringandHakePopulationTrendsLine}). In addition, the NMDS showed that the two are negstively related to some extent (\ref{fig:preyspeciesNMDS}). As hakes tend to be less energy-dense than herrings (@anthony_lipid_2000; spitz_proximate_2010), and therefore may be an inferior prey item, one hypothesis surrounding these prey items in seabird diets is that hakes may act as filler species when herrings aren't abundant, but the trends in the diet data don't fully support this. More detailed analysis of the tern diet data, paired with incorporation of herring and hake population data from fisheries-independent sources (i.e. trawl survey data, spawning stock models, etc.) will help to parse apart the relationship between these two important forage species in the tern diet and the Gulf of Maine more broadly. 

The common tern diet also showed variability in the CPUE, indicating that prey availability is not entirely consistent across time (Figure \ref{fig:preyspeciesproportions}). This result was expected, as forage fish abundance is known to be patchy in space and time. One might expect that the terns would supplement their diet with other prey items when the usual suite of species drop in abundance, but the data here suggest that they are not able to supplement their diet enough to account for drops in their usual prey items on the annual level. In the context of these analyses, if terns were supplementing their diet in low fish abundance years, one might expect to see prey diversity (Shannon Index) increase, which we do not (Figure \ref{fig:shannon}). Further research will ask whether CPUE trends in the tern diet are also reflected in fisheries-independent data in the region across varying time-scales (i.e. does low herring CPUE in tern diet in one year predict low herring CPUE in adult recruitment to fisheries 3 or 4 years later).

The NMDS results showed interesting groupings between species, but further analysis addressing nest-level differences in diet will be necessary to parse apart these relationships, as individual terns can vary greatly in their foraging behavior. Future work will also include a more detailed and biologically/ecologically relevant assessment of time periods, as the three time bins used here had no ecological basis. Future work will assess the forage fish community present in the Gulf of Maine using fisheries-independent data, allowing for the comparison of the diet community between terns and the fishes available to them in the region. 

The results showing increases in the size of prey items taken by terns over time are particularly intriguing (\ref{fig:HerringSizeRegression} and \ref{fig:hakeSizeRegression}). One possible explanation is that fish spawning phenology has changed such that fish are spawning slightly earlier and therefore are larger by the time they are ingested by terns. Another explanation is that fish movements have changed, such that he distribution of age classes has shifted over time placing larger individuals in the vacinity of the colony when previously, smaller fish were more common in that area. In the case of herrings, which show seasonal migration, this might be the result of changes in migration phenology. Another explanation for the results is that the terns have gradually shifted their behavior, opting to select larger and larger fish over time. Further exploration of the tern diet dataset along with exploration of fisheries-independent data will help to contextualize the results observed. 

While the results from this pilot effort suggest that Common Terns are sensitive predators potentially useful for fisheries monitoring, gaps in understanding of prey selection by the species remain a hindrance (@einoder_review_2009). To gain the understanding of tern prey selection necessary to contextualize these results and any work comparing tern diet and fisheries-independent data sources, future work will sample the prey environment available to the terns via net-based sampling and eDNA. 
\newpage

#References